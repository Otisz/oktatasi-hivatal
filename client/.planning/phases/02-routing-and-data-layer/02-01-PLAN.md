---
phase: 02-routing-and-data-layer
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - src/router/index.ts
  - src/main.ts
  - src/App.vue
  - src/views/ApplicantsView.vue
  - src/views/ApplicantDetailView.vue
  - src/composables/useProgress.ts
  - src/lib/query.ts
autonomous: true
requirements: [NAV-01, NAV-02, NAV-03]

must_haves:
  truths:
    - "Navigating to / in the browser redirects to /applicants without a 404 or blank screen"
    - "Navigating directly to /applicants/some-uuid renders the detail route component (placeholder)"
    - "All unknown URLs redirect silently to /applicants (no 404 page)"
    - "Detail view placeholder shows a back link to /applicants"
    - "Persistent header shows 'Oktatasi Hivatal' and 'Felveteli pontszamolo' on every route"
    - "A subtle top progress bar appears during route transitions"
  artifacts:
    - path: "src/router/index.ts"
      provides: "Vue Router instance with history mode, two named routes, redirect, catch-all"
      exports: ["router"]
    - path: "src/views/ApplicantsView.vue"
      provides: "Placeholder list view with layout shell"
    - path: "src/views/ApplicantDetailView.vue"
      provides: "Placeholder detail view with back link to /applicants"
    - path: "src/composables/useProgress.ts"
      provides: "Reactive navigation state for progress bar"
      exports: ["isNavigating"]
    - path: "src/App.vue"
      provides: "Layout shell with persistent header, progress bar, and RouterView"
    - path: "src/main.ts"
      provides: "Router plugin registered alongside VueQueryPlugin"
    - path: "src/lib/query.ts"
      provides: "QueryClient with 30-minute staleTime"
  key_links:
    - from: "src/router/index.ts"
      to: "src/views/ApplicantsView.vue"
      via: "route component import"
      pattern: "import ApplicantsView from '@/views/ApplicantsView.vue'"
    - from: "src/router/index.ts"
      to: "src/views/ApplicantDetailView.vue"
      via: "route component import"
      pattern: "import ApplicantDetailView from '@/views/ApplicantDetailView.vue'"
    - from: "src/main.ts"
      to: "src/router/index.ts"
      via: ".use(router)"
      pattern: "\\.use\\(router\\)"
    - from: "src/App.vue"
      to: "src/router/index.ts"
      via: "RouterView component"
      pattern: "<RouterView"
    - from: "src/router/index.ts"
      to: "src/composables/useProgress.ts"
      via: "navigation guard sets isNavigating"
      pattern: "isNavigating\\.value"
---

<objective>
Install Vue Router, configure two named routes with history mode, create placeholder view components, and build the persistent app shell with header and progress bar.

Purpose: Establishes all client-side routing so that every URL in the app resolves to a component. Placeholder views are structural shells that Phase 3 and Phase 4 will fill with real content.

Output: Working router with `/applicants` and `/applicants/:id` routes, redirect from `/`, catch-all for unknown paths, persistent header, progress bar, and placeholder views.
</objective>

<execution_context>
@/Users/otisz/.claude/get-shit-done/workflows/execute-plan.md
@/Users/otisz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-routing-and-data-layer/02-CONTEXT.md
@.planning/phases/02-routing-and-data-layer/02-RESEARCH.md
@.planning/phases/01-foundation/01-02-SUMMARY.md

<interfaces>
<!-- Key types and contracts the executor needs. Extracted from codebase. -->

From src/main.ts (current — will be modified):
```typescript
import { VueQueryPlugin } from '@tanstack/vue-query'
import { createApp } from 'vue'
import { queryClient } from '@/lib/query'
import App from './App.vue'
import './assets/main.css'

createApp(App).use(VueQueryPlugin, { queryClient }).mount('#app')
```

From src/lib/query.ts (current — staleTime will be updated):
```typescript
import { QueryClient } from '@tanstack/vue-query'

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60 * 5,
    },
  },
})
```

From src/App.vue (current — will be replaced):
```vue
<script setup lang="ts">
</script>

<template>
  <div class="min-h-screen bg-gray-50 flex items-center justify-center">
    <h1 class="text-2xl font-bold text-gray-900">Oktatasi Hivatal</h1>
  </div>
</template>
```

From package.json (vue-router NOT yet installed):
```json
{
  "dependencies": {
    "@tanstack/vue-query": "^5.92.9",
    "axios": "^1.13.6",
    "vue": "^3.5.29"
  }
}
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Vue Router, create router config, register in main.ts, update staleTime</name>
  <files>src/router/index.ts, src/main.ts, src/lib/query.ts, src/views/ApplicantsView.vue, src/views/ApplicantDetailView.vue, src/composables/useProgress.ts</files>
  <action>
**Step 1: Install vue-router**

Run `npm install vue-router` (installs v5.x which has no breaking API changes vs v4 — all patterns are identical).

**Step 2: Create minimal placeholder views** (router imports these, so they must exist first)

Create `src/views/ApplicantsView.vue`:
```vue
<script setup lang="ts">
</script>

<template>
  <div class="max-w-4xl mx-auto px-4 py-6">
    <h2 class="text-lg font-semibold text-gray-900">Jelentkezok</h2>
    <!-- Phase 3 fills list content here -->
  </div>
</template>
```

Create `src/views/ApplicantDetailView.vue` with `RouterLink` back navigation (NAV-02):
```vue
<script setup lang="ts">
import { RouterLink, useRoute } from 'vue-router'

const route = useRoute()
</script>

<template>
  <div class="max-w-4xl mx-auto px-4 py-6">
    <RouterLink to="/applicants" class="text-sm text-blue-600 hover:underline mb-4 inline-block">
      &larr; Vissza
    </RouterLink>
    <h2 class="text-lg font-semibold text-gray-900">Pontozas</h2>
    <p class="text-gray-500 text-sm mt-1">{{ route.params.id }}</p>
    <!-- Phase 4 fills score content here -->
  </div>
</template>
```

**Step 3: Create progress bar composable**

Create `src/composables/useProgress.ts` — a reactive ref driven by router navigation guards. Zero-dependency approach using Tailwind (no nprogress). This keeps the progress bar implementation minimal.

```typescript
import { ref } from 'vue'

export const isNavigating = ref(false)
```

**Step 4: Create router config**

Create `src/router/index.ts` with:
- `createRouter` + `createWebHistory` (HTML5 history mode — clean URLs)
- Two named routes: `applicants` → `/applicants` (ApplicantsView), `applicant-detail` → `/applicants/:id` (ApplicantDetailView)
- Root redirect: `{ path: '/', redirect: { name: 'applicants' } }` (NAV-03)
- Catch-all: `{ path: '/:pathMatch(.*)*', redirect: { name: 'applicants' } }` — silently redirects unknown URLs (no 404 page, per user decision)
- Catch-all MUST be last in the routes array (Vue Router matches in array order)
- Navigation guards: `router.beforeEach` sets `isNavigating.value = true`, `router.afterEach` sets `isNavigating.value = false`

Import views with static imports (not lazy loading — small app, two views):
```typescript
import ApplicantsView from '@/views/ApplicantsView.vue'
import ApplicantDetailView from '@/views/ApplicantDetailView.vue'
```

Export `router` as a named export.

**Step 5: Register router in main.ts**

Update `src/main.ts` to import `{ router }` from `@/router` and chain `.use(router)` BEFORE `.use(VueQueryPlugin, { queryClient })`:

```typescript
import { VueQueryPlugin } from '@tanstack/vue-query'
import { createApp } from 'vue'
import { queryClient } from '@/lib/query'
import { router } from '@/router'
import App from './App.vue'
import './assets/main.css'

createApp(App)
  .use(router)
  .use(VueQueryPlugin, { queryClient })
  .mount('#app')
```

**Step 6: Update staleTime to 30 minutes**

In `src/lib/query.ts`, change `staleTime: 1000 * 60 * 5` to `staleTime: 1000 * 60 * 30` (30 minutes — per user decision, static seeded data).

**IMPORTANT: Do NOT import `axios` directly anywhere — always use `http` from `@/lib/http`.**
  </action>
  <verify>
    <automated>cd /Users/otisz/Projects/oktatasi-hivatal/client && npx vue-tsc --noEmit && npx biome check .</automated>
  </verify>
  <done>
- vue-router is installed in package.json dependencies
- src/router/index.ts exports `router` with createWebHistory, two named routes, root redirect, and catch-all
- src/main.ts uses router plugin before VueQueryPlugin
- src/views/ApplicantsView.vue and ApplicantDetailView.vue exist as placeholder shells
- ApplicantDetailView.vue has RouterLink back navigation to /applicants
- src/composables/useProgress.ts exports `isNavigating` ref
- src/lib/query.ts staleTime is 30 minutes (1000 * 60 * 30)
- Navigation guards in router set isNavigating on beforeEach/afterEach
- TypeScript compiles with no errors, Biome reports no violations
  </done>
</task>

<task type="auto">
  <name>Task 2: Build App.vue layout shell with persistent header, progress bar, and RouterView</name>
  <files>src/App.vue</files>
  <action>
Replace `src/App.vue` with the persistent layout shell:

**Header (always visible on all routes):**
- Dual-line format per user decision: "Oktatasi Hivatal" as main title (institutional name), "Felveteli pontszamolo" as subtitle (functional descriptor)
- Header sits in a white bar with bottom border, content constrained to max-w-4xl centered

**Progress bar (subtle top bar):**
- Import `isNavigating` from `@/composables/useProgress`
- Render a thin fixed bar at the very top of the viewport when `isNavigating` is true
- Use `v-if="isNavigating"` on a `<div>` with classes: `fixed top-0 left-0 h-0.5 bg-blue-500 animate-pulse w-full z-50`
- This creates a subtle pulsing line at the top during route transitions (like YouTube/GitHub style, but simpler)

**RouterView:**
- Import `RouterView` from `vue-router`
- Place `<RouterView />` inside a `<main>` element below the header

**Full structure:**
```vue
<script setup lang="ts">
import { RouterView } from 'vue-router'
import { isNavigating } from '@/composables/useProgress'
</script>

<template>
  <div class="min-h-screen bg-gray-50">
    <div
      v-if="isNavigating"
      class="fixed top-0 left-0 h-0.5 bg-blue-500 animate-pulse w-full z-50"
    />
    <header class="bg-white border-b border-gray-200">
      <div class="max-w-4xl mx-auto px-4 py-4">
        <h1 class="text-xl font-bold text-gray-900">Oktatasi Hivatal</h1>
        <p class="text-sm text-gray-500">Felveteli pontszamolo</p>
      </div>
    </header>
    <main>
      <RouterView />
    </main>
  </div>
</template>
```

Run `npx biome check --fix .` after writing to ensure formatting compliance.

**Do NOT add any logic beyond layout — no data fetching, no state management in App.vue.**
  </action>
  <verify>
    <automated>cd /Users/otisz/Projects/oktatasi-hivatal/client && npm run build && npx biome check .</automated>
  </verify>
  <done>
- src/App.vue renders persistent header with "Oktatasi Hivatal" / "Felveteli pontszamolo" on all routes
- RouterView renders the matched route component below the header
- Progress bar div appears when isNavigating is true (thin blue pulse at top of viewport)
- `npm run build` succeeds (vue-tsc type check + Vite bundle)
- Biome reports no violations
  </done>
</task>

</tasks>

<verification>
After both tasks complete:

1. **Type check passes:** `npx vue-tsc --noEmit` exits 0
2. **Build succeeds:** `npm run build` exits 0 (includes type check + Vite bundle)
3. **Lint passes:** `npx biome check .` exits 0
4. **Router exists:** `src/router/index.ts` exports `router` with 4 route entries (applicants, applicant-detail, root redirect, catch-all)
5. **main.ts registers router:** `.use(router)` appears before `.use(VueQueryPlugin, ...)`
6. **Views exist:** `src/views/ApplicantsView.vue` and `src/views/ApplicantDetailView.vue` both exist
7. **Back link exists:** `ApplicantDetailView.vue` contains `RouterLink` to `/applicants` with text containing "Vissza"
8. **Header persistent:** `App.vue` contains "Oktatasi Hivatal" and "Felveteli pontszamolo" outside of RouterView
9. **staleTime updated:** `src/lib/query.ts` contains `1000 * 60 * 30`
</verification>

<success_criteria>
- Navigating to `/` redirects to `/applicants` and renders ApplicantsView placeholder
- Navigating to `/applicants/any-uuid` renders ApplicantDetailView placeholder with back link
- Navigating to `/nonexistent/path` redirects to `/applicants`
- Header "Oktatasi Hivatal" / "Felveteli pontszamolo" visible on all routes
- Progress bar div present in App.vue template, wired to isNavigating ref
- All TypeScript compiles, Biome passes, build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/02-routing-and-data-layer/02-01-SUMMARY.md`
</output>
